<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="d3214ac1e5e4abff1cb40dd11233a608">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="c4">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="/static/images/codeforces-vk-square-en.png">
    <meta property="og:title" content="Problem - 87E - Codeforces">
    <meta property="og:site_name" content="Codeforces">
    
    <meta name="cc" content="z252cg24s4rj">
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Problem - 87E - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="/static/css/font-awesome.min.css" type="text/css" charset="utf-8">

        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="shortcut icon" type="image/png" href="/static/favicon.png">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="/static/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="/static/css/sidebar-menu.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="/static/css/status.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="/static/css/community.css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="/static/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="/static/js/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="/static/js/sockjs-0.2.1.min.js"></script>
    <script type="text/javascript" src="/static/js/vertxbus-1.2.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="/static/js/facebox.js"></script>
    <script type="text/javascript" src="/static/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="/static/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="/static/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="/static/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="/static/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="/static/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="/static/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="/static/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="/static/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="/static/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="/static/js/codeforces.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="/static/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="/static/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="//yandex.st/share/share.js" charset="utf-8"></script>
    
    <script type="text/javascript" src="/static/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="/static/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->


</head>
<body>
<span style="display:none;" class="csrf-token" data-csrf="d3214ac1e5e4abff1cb40dd11233a608"> </span>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 30px;"><i class="icon-circle-arrow-up"></i></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
        <!-- Frame: Header.ftl -->
<div id="header" style="position:relative;">
    <div style="float:left;">
            <a href="/"><img src="/static/images/codeforces-logo-with-telegram.png"></a>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="?locale=en"><img src="/static/images/flags/24/gb.png" title="In English" alt="In English"></a>
            <a href="?locale=ru"><img src="/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
        </div>
        <div>
                <a href="/enter">Enter</a>
                 | 
                <a href="/register">Register</a>
                
        </div>
    </div>
    <div style="font-size:0.8em;margin-top:0.25em;position:absolute;right:0;top:4.25em;">
    </div>
    <br style="clear: both;">
</div>
<!-- /Frame: Header.ftl -->
        <!-- Frame: MainMenuFrame.ftl -->
    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt"> </div>
            <div class="roundbox-rt"> </div>
            <div class="roundbox-lb"> </div>
            <div class="roundbox-rb"> </div>
<div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class="current"><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/api/help">API</a></li>
                <li class=""><a href="/help">Help</a></li>
                <li class=""><a href="/bayan2015">Bayan 2015 <img class="icon" src="http://stat.codeforces.ru/images/icons/cup.png"></a></li>
                <li class=""><a href="/rcc2014">RCC <img class="icon" src="http://stat.codeforces.ru/images/icons/cup.png"></a></li>
    </ul>
    <form method="post" action="/search">
<input type="hidden" name="csrf_token" value="d3214ac1e5e4abff1cb40dd11233a608">
        <input class="search" name="query" data-isplaceholder="true" value="Search by tag">
    </form>
    <br style="clear: both;">
</div>
    </div>
<!-- /Frame: MainMenuFrame.ftl -->
    <script type="text/javascript">
        $(document).ready(function() {
            $("input.search").focus(function() {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        <br style="height: 3em; clear: both;">
        <div style="position: relative;">
                    <div id="sidebar">
<!-- Frame: ComplexFrame.ftl -->
<!-- Frame: ComplexFrame.ftl --><!-- Frame: ContestStateSidebarFrame.ftl -->
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt"> </div>
            <div class="roundbox-rt"> </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;"><a style="color: black" href="/contest/87">Codeforces Beta Round #73 (Div. 1 Only)</a></th>
                </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class="contest-state-phase">Finished</span></td>
                    </tr>
            </tbody>
        </table>
    </div>
<!-- /Frame: ContestStateSidebarFrame.ftl -->

<!-- Frame: ProblemTagsFrame.ftl -->
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt"> </div>
            <div class="roundbox-rt"> </div>
        <div class="caption titled">→ Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt"> </div>
            <div class="roundbox-rt"> </div>
            <div class="roundbox-lb"> </div>
            <div class="roundbox-rb"> </div>
<span class="tag-box" style="font-size:12px;" title="Geometry, computational geometry">
    geometry
</span>
    </div>
    <div style="clear:both;text-align:right;font-size:11px;">
            <span title="Please login into the Codeforces" class="notice">No tag edit access</span>
    </div>
</div>
    </div>

<form id="addTagForm" action="/data/problemTags" method="post" style="display:none;">
<input type="hidden" name="csrf_token" value="d3214ac1e5e4abff1cb40dd11233a608">
    <input name="action" type="hidden" value="addTag">
    <input name="problemId" type="hidden" value="461">
    <input name="tagName" type="hidden" value="">
</form>

<form id="removeTagForm" action="/data/problemTags" method="post" style="display:none;">
<input type="hidden" name="csrf_token" value="d3214ac1e5e4abff1cb40dd11233a608">
    <input name="action" type="hidden" value="removeTag">
    <input name="problemId" type="hidden" value="461">
    <input name="tagName" type="hidden" value="">
</form>

<script type="text/javascript">
    $(".tag-box img").click(function () {
        var tagName = $(this).attr("value");
        Codeforces.confirm("Are you sure you want to remove this tag?", function () {
            $("#removeTagForm input[name=tagName]").val(tagName);
            $("#removeTagForm").submit();
        }, function () {
        }, "Yes", "No");
    });

    $("#addTagLink").click(function () {
        $(this).hide();
        $("#addTagLabel").show();
        return false;
    });

    $("#addTagSelect").change(function () {
        var tagName = $(this).val();
        if (tagName === "") {
            $("#addTagLabel").hide();
            $("#addTagLink").show();
        } else {
            $("#addTagForm input[name=tagName]").val(tagName);
            $("#addTagForm").submit();
        }
    });
</script>
<!-- /Frame: ProblemTagsFrame.ftl --><!-- Frame: ContestResourcesSidebarFrame.ftl -->
<style type="text/css">
#new-resource-form tr td {
padding-top: 0.5em;
}
#new-resource-form input:not([type="submit"]) {
font-size: 0.8em;
}
#new-resource-form select {
font-size: 0.8em;
}
</style>
<div class="roundbox sidebox sidebar-menu" style="">
<div class="roundbox-lt"> </div>
<div class="roundbox-rt"> </div>
<div class="caption titled">→ Contest materials
<div class="top-links">
</div>
</div>
<ul>
<li>
<span>
<a href="http://codeforces.ru/blog/entry/2115" title="Анонс" target="_blank">Announcement #1</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceid="981" resourcename="Анонс" resourcemanual="true" src="/static/images/icons/close-10x10.png" style="position: relative;bottom: -1px;left: 1px;cursor: pointer;">
</span>
<div style="clear: both;"></div>
</li>
<li>
<span>
<a href="/blog/entry/2115" title="Codeforces Beta Round #73" target="_blank">Announcement #2</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceid="985" resourcename="Codeforces Beta Round #73" resourcemanual="true" src="/static/images/icons/close-10x10.png" style="position: relative;bottom: -1px;left: 1px;cursor: pointer;">
</span>
<div style="clear: both;"></div>
</li>
<li>
<span>
<a href="/blog/entry/2121" title="CodeForces Beta Round #73 div. 1 analysis (particulary with div. 2)" target="_blank">Tutorial</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceid="980" resourcename="CodeForces Beta Round #73 div. 1 analysis (particulary with div. 2)" resourcemanual="true" src="/static/images/icons/close-10x10.png" style="position: relative;bottom: -1px;left: 1px;cursor: pointer;">
</span>
<div style="clear: both;"></div>
</li>
</ul>
</div>
<!-- /Frame: ContestResourcesSidebarFrame.ftl --><!-- /Frame: ComplexFrame.ftl --><!-- /Frame: ComplexFrame.ftl -->
</div>
                    <div id="content" class="content-with-sidebar">
                <div class="second-level-menu">
<!-- Frame: SecondLevelMenuFrame.ftl -->
<ul class="second-level-menu-list">
        <li class="current"><a href="/problemset">Problems</a></li>
        <li><a href="/problemset/submit">Submit</a></li>
        <li><a href="/problemset/status">Status</a></li>
        <li><a href="/problemset/standings">Standings</a></li>
        <li><a href="/problemset/customtest">Custom test</a></li>
</ul>
<!-- /Frame: SecondLevelMenuFrame.ftl -->
</div>
<!-- Frame: ProblemViewFrame.ftl -->
<div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement">
<div class="header">
<div class="title">E. Mogohu-Rea Idol</div>
<div class="time-limit">
<div class="property-title">time limit per test</div>3 seconds</div>
<div class="memory-limit">
<div class="property-title">memory limit per test</div>256 megabytes</div>
<div class="input-file">
<div class="property-title">input</div>standard input</div>
<div class="output-file">
<div class="property-title">output</div>standard output</div>
</div>
<div>
<p>A long time ago somewhere in the depths of America existed a powerful tribe governed by the great leader Pinnie-the-Wooh. Once the tribe conquered three Maya cities. Pinnie-the-Wooh grew concerned: there had to be some control over the conquered territories. That's why he appealed to the priests of the supreme god Mogohu-Rea for help.</p>
<p>The priests conveyed the god's will to him: to control these three cities he should put an idol to Mogohu-Rea — that will create a religious field over the cities. However, the idol is so powerful that it can easily drive the people around it mad unless it is balanced by exactly three sacrifice altars, placed one in each city. To balance the idol the altars should be placed so that the center of mass of the system of these three points coincided with the idol. When counting the center of mass consider that all the altars have the same mass.</p>
<p>Now Pinnie-the-Wooh is thinking where to put the idol. He has a list of hills, that are suitable to put an idol there. Help him to identify on which of them you can put an idol without risking to fry off the brains of the cities' population with the religious field.</p>
<p>Each city has a shape of a convex polygon such that no three vertexes lie on a straight line. The cities can intersect. Each altar should be attached to the city through a special ceremony, besides, it must be situated on the city's territory (possibly at the border). Thus, there may be several altars on a city's territory, but exactly one of them will be attached to the city. The altars, the idol and the hills are points on the plane, some of them may coincide.</p>
<p>The hills are taken into consideration independently from each other, the altars' location for different hills may also be different.</p>
</div>
<div class="input-specification">
<div class="section-title">Input</div>
<p>First follow descriptions of the three cities, divided by empty lines. The descriptions are in the following format:</p>
<p>The first line contains an integer <span class="tex-span"><i>n</i></span>, which represent the number of the polygon's vertexes (<span class="tex-span">3 ≤ <i>n</i> ≤ 5·10<sup class="upper-index">4</sup></span>). Next <span class="tex-span"><i>n</i></span> lines contain two integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> each, they are the coordinates of the polygon's <span class="tex-span"><i>i</i></span>-th vertex in the counterclockwise order.</p>
<p>After the cities' description follows the integer <span class="tex-span"><i>m</i></span> (<span class="tex-span">1 ≤ <i>m</i> ≤ 10<sup class="upper-index">5</sup></span>), which represents the number of hills. Next <span class="tex-span"><i>m</i></span> lines each contain two integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>j</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>j</i></sub></span>, they are the coordinates of the <span class="tex-span"><i>j</i></span>-th hill.</p>
<p>All the coordinates in the input data do not exceed <span class="tex-span">5·10<sup class="upper-index">8</sup></span> in the absolute value.</p>
</div>
<div class="output-specification">
<div class="section-title">Output</div>
<p>For each hill print on a single line "<span class="tex-font-style-tt">YES</span>" (without the quotes) or "<span class="tex-font-style-tt">NO</span>" (without the quotes), depending on whether the three sacrifice altars can be put to balance the idol or not.</p>
</div>
<div class="sample-tests">
<div class="section-title">Sample test(s)</div>
<div class="sample-test">
<div class="input">
<div class="title">Input</div>
<pre>3<br>0 0<br>1 0<br>1 1<br><br>4<br>8 8<br>5 5<br>6 4<br>8 4<br><br>3<br>-1 -1<br>-3 -1<br>-2 -2<br><br>5<br>0 0<br>2 1<br>7 1<br>1 1<br>5 3<br></pre>
</div>
<div class="output">
<div class="title">Output</div>
<pre>NO<br>YES<br>NO<br>YES<br>NO<br></pre>
</div>
</div>
</div>
<div class="note">
<div class="section-title">Note</div>
<p>For the hill at <span class="tex-span">(2, 1)</span> the altars can be placed at the points <span class="tex-span">(1, 0), (7, 5), ( - 2,  - 2)</span>, for the hill at <span class="tex-span">(1, 1)</span> — at the points <span class="tex-span">(0, 0), (6, 4), ( - 3,  - 1)</span>. Many other groups of three points can do the trick. There are no suitable points for other hills.</p>
</div>
</div></div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
<!-- /Frame: ProblemViewFrame.ftl -->            </div>
        </div>
<!-- Frame: Footer.ftl -->
<br style="clear: both;">
<div id="footer">
    <div>
<a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2014 Mike Mirzayanov</div>
    <div>The only programming contests Web 2.0 platform</div>
    <div>Server time: 2014-12-10 11:33:48 (c4).</div>
</div>
<!-- /Frame: Footer.ftl -->    <script type="text/javascript">
        $(document).ready(function() {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function(){
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function() {
                    $(this).animate({
                        'opacity':'1',
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function(){
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }
            Codeforces.focusOnError();
        });
    </script>
</div>
</body>
</html>